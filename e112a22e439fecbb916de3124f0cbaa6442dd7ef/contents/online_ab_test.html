<!DOCTYPE html>
<html class="writer-html5" lang="ko" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Online A/B 테스트 &mdash; battleground 0.1 문서</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="색인" href="../genindex.html" />
    <link rel="search" title="검색" href="../search.html" />
    <link rel="next" title="battleground" href="../modules.html" />
    <link rel="prev" title="Offline A/B 테스트" href="offline_ab_test.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> battleground
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="instruction.html">패키지 설명</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Sphinx 편집 Guideline</a></li>
<li class="toctree-l1"><a class="reference internal" href="process.html">활용 Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="offline_ab_test.html">Offline A/B 테스트</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Online A/B 테스트</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">샘플 크기 추정</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">전환 성능 비교</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">빈도 통계 기반</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">카이제곱 검증</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">비율 검증</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id6">베이지안 기반</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-b">베이지안 A/B 테스트</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-b-c">베이지안 A/B/C 테스트</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-b-c-d">베이지안 A/B/C/D 테스트</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id7">랭킹 기반 추천 성능</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#map">MAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mar">MAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ndcg">nDCG</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id8">연속 값 차이 추정</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#t">독립 표본 T 검증</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">베이지안 T 검증</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">APIs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">battleground</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">battleground</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Online A/B 테스트</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/contents/online_ab_test.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="online-a-b">
<h1>Online A/B 테스트<a class="headerlink" href="#online-a-b" title="이 표제에 대한 퍼머링크"></a></h1>
<section id="id1">
<h2>샘플 크기 추정<a class="headerlink" href="#id1" title="이 표제에 대한 퍼머링크"></a></h2>
<p>Battleground 의 샘플 크기 추정은 빈도 통계학을 따라 정의되었습니다. 사전 가정(분산 동일 유무)의 차이에 따라 크게 두 가지 방법으로 구성이 되었으며 둘 모두 구현되어 있어서 사용자가 선택해서 활용할 수 있도록 하였습니다. 이 들의 수행은 아래의 수식을 따라 수행되었습니다. 첫 번째 수식은 스탠포트의 강의에서 발췌[1]한 샘플 크기 추정 수식입니다.</p>
<p><img alt="stanford" src="../_images/stanford.png" /></p>
<p>두 번째 수식은 Evan Miler 의 Post[2, 3]에서 발췌한 샘플 크기 추정 수식입니다.</p>
<p><img alt="evan" src="../_images/evan.png" /></p>
<p>이 방법들을 사용하기 위해서는 사전에 알아야하는 몇몇 값들이 있습니다.</p>
<ul class="simple">
<li><p>p : 기존 알고리즘의 전환율입니다. 전환율의 정의는 클릭 혹은 가입 등 다양하게 정의될 수 있으며 예시에서는 클릭으로 진행될 예정입니다.</p></li>
<li><p>alpha : 1종 오류의 크기입니다. 1종 오류는 간단하게 말하면 맞는데 틀리다고 하는 경우를 의미합니다.</p></li>
<li><p>power : 2종 오류도 알아야합니다. 2종오류는 틀린데 맞다고 할 경우입니다.</p></li>
<li><p>expected : 새로운 알고리즘의 기대되는 전환율입니다. 예시에서는 Offline A/B 테스트의 결과를 입력하였습니다.</p></li>
<li><p>bucket_min_size : 기존 알고리즘의 버킷당 1일 최소 유입 유저 수 입니다. 이는 최소 몇일 간 테스트를 진행할 지 모니터링 기간을 계산하기 위함이며 계산된 샘플크기로부터 최소 유저수를 나누어 계산하며 1주일보다 작은 경우 1주일을 반환하게 됩니다.</p></li>
<li><p>mde_method : MDE 방법입니다. MDE 값은 Minimum detectable effect, 최소한의 검출 가능 효과를 의미하며 두 알고리즘의 전환율의 차이를 어느 정도로 볼 지 결정하는 값입니다. 현재는 두 알고리즘 각각의 전환율의 차이, 배수, Cohen’s h가 구현되어있으며 기본값은 Cohen’s h를 따라 계산하는 방법입니다. 그 외에도 사용자가 직접 추정한 두 알고리즘 간의 전환율의 차이를 직접 입력하여 계산할 수 있을 수 있도록 개발되었습니다.</p></li>
<li><p>case : 동일 분산의 가정 유무입니다. 각 사전에 정의된 값을 따라 계산되어 각 버킷 당 최소 샘플 수를 반환하게 됩니다. 기본 값은 동일 분산이 아니라는 가정하에 계산됩니다.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Online A/B test 사용 예시</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_ctr</span> <span class="o">=</span> <span class="p">(</span><span class="n">bucket_a</span><span class="p">[</span><span class="s1">&#39;reward&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">bucket_a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;기존 CTR : &quot;</span><span class="p">,</span> <span class="n">base_ctr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Offline A/B test 결과 기대 CTR : &quot;</span><span class="p">,</span> <span class="n">cis_weight</span><span class="p">[</span><span class="s1">&#39;CIS_weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="go">기존 CTR :  0.01483019427554501</span>
<span class="go">Offline A/B test 결과 기대 CTR :  0.06893937460876202</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_size_estimater</span> <span class="o">=</span> <span class="n">SampleSizeEstimater</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="p">,</span> <span class="n">power</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">base_ctr</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">cis_weight</span><span class="p">[</span><span class="s1">&#39;CIS_weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_size</span><span class="p">,</span> <span class="n">require_periods</span> <span class="o">=</span> <span class="n">sample_size_estimater</span><span class="o">.</span><span class="n">cal_sample_size</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;비교하고자 하는 모델의 CTR 이 5% 임을 검증하려고 할때 필요한 실험(버킷) 당 최소 샘플 수 : &quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>
<span class="go">비교하고자 하는 모델의 CTR 이 5% 임을 검증하려고 할때 필요한 실험(버킷) 당 최소 샘플 수 :  15954</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_size_estimater</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span> <span class="c1">#alpha 와 power 별 샘플 크기 plot</span>
</pre></div>
</div>
<p><img alt="dist" src="../_images/dist.png" /></p>
</section>
<section id="id2">
<h2>전환 성능 비교<a class="headerlink" href="#id2" title="이 표제에 대한 퍼머링크"></a></h2>
<p>battleground 의 여러가지 성능 측정 방법들은 사용의 편리함을 위하여 동일한 형태를 기준으로 개발되었습니다. 대부분 Pandas DataFrame 을 받는 형식이며 파라미터는 컬럼명을 받는 등 sklearn 에서 수행하듯이 어느정도 정해진 형태의 데이터를 받아 수행할 수 있도록 수행 되었습니다. 성능을 더 빠르게 하기 위하여 list 나 array 를 받아 numpy로 연산할 수 있지만 사용자로 하여금 익숙해지면 손쉽게 쓸 수 있도록 하는 것에 초점을 맞추어 어느정도의 자유도를 제한하고 기준을 통일하여 진행하였습니다. 만약 추후 성능 이슈가 발생 시 성능을 올릴 수 있는 여러 trickly 한 방법들을 사용하여 추가로 개발을 지원할 예정이니 필요하시면 담당자에게 연락주시면 감사합니다. 또한 A/B 테스트 결과를 추정하는 것을 먼저 개발해두었습니다. A/B/C 나 A/B/C/D 등은 여건이 되는대로 점진적으로 고도화를 해가며 추가할 예정이니 참조하여 주시면 감사합니다.</p>
<section id="id3">
<h3>빈도 통계 기반<a class="headerlink" href="#id3" title="이 표제에 대한 퍼머링크"></a></h3>
<section id="id4">
<h4>카이제곱 검증<a class="headerlink" href="#id4" title="이 표제에 대한 퍼머링크"></a></h4>
<p>battleground 의 전환율 비교 성능은 크게 빈도통계 기반 방식과 베이지안 방식 2가지를 준비해두었습니다. 빈도 통계 방식은 카이제곱 검증과 비율 검증이 구현되어 있으며 카이제곱은 추천 유무 별 전환 유무(클릭/가입 등)를 검증하기 위한 목적으로 넣었습니다. 카이제곱 검증에 대한 자세한 내용은 [4]을 참조하시면 자세히 보실 수 있습니다. H0 는 추천 유무 별 전환 유무는 연관성이 없다 이며 H1은 추천 유무 별 전환 유무가 연관성이 있다 입니다. 즉, 추천 유무가 전환과의 연관성이 있는지를 검증하기 위한 목적으로 사용할 수 있습니다. 샘플 크기 추정을 통해 어느정도 수 이상의 샘플을 테스트 할 것이라고 가정하였기 때문에 피셔의 정확도 검증은 구현되어 있지 않습니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Chi sqare test 사용 예시</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chi_squ</span> <span class="o">=</span> <span class="n">ConversionEstimater</span><span class="p">(</span><span class="n">control</span> <span class="o">=</span> <span class="n">bucket_a</span><span class="p">[[</span><span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="s1">&#39;prod_id&#39;</span><span class="p">,</span> <span class="s1">&#39;reward&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">random_bucket</span><span class="p">[[</span><span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="s1">&#39;prod_id&#39;</span><span class="p">,</span> <span class="s1">&#39;reward&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="p">,</span> <span class="n">control_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="p">,</span> <span class="n">target_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="p">,</span> <span class="n">control_reward_val</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="p">,</span> <span class="n">target_reward_val</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chi2</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">effect_size</span> <span class="o">=</span> <span class="n">chi_squ</span><span class="o">.</span><span class="n">chi_square_val</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">p_val</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;추천 유무 별 전환이 연관성이 있다고 주장할 수 있다. 즉, 추천 유무가 전환에 영향을 준다고 주장할 수 있는 충분한 근거를 얻었다.&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;추천 유무 별 전환이 연관성이 있다고 주장할 수 없다. 즉, 추천 유무가 전환에 영향을 준다고 주장할 수 있는 충분한 근거를 얻지 못하였다.&quot;</span><span class="p">)</span>
<span class="go">추천 유무 별 전환이 연관성이 있다고 주장할 수 있다. 즉, 추천 유무가 전환에 영향을 준다고 주장할 수 있는 충분한 근거를 얻었다. #추천 알고리즘이 전환에 영향을 준다고 할 수 있다.</span>
</pre></div>
</div>
<p>반환되는 결과는 카이제곱 통계량과 p value, 자유도, 기대값, 효과크기입니다. 반환된 결과를 기반으로 영향을 준다고 볼 수 있는지를 검증할 수 있으며 효과크기를 통해 얼만큼 영향을 준다고 볼 수 있는지를 검증할 수 있습니다. 카이제곱 실행 시 자유도가 5이하인 경우에 대해서 효과 크기가 어느 정도 차이가 나는지를 일반적으로 해석하는 DataFrame을 출력해줍니다. 예를 들어, 대조군 x 처지군의 클릭/미클릭의 경우 자유도가 1이므로 자유도가 1일 경우 일반적으로 효과크기를 해석하는 기준을 아래와 같이 출력해줍니다.</p>
<p><img alt="degree" src="../_images/degree.png" /></p>
<p>하지만 이 크기가 절대적인 것은 아니며 상황과 데이터에 따라 p-value와 같이 연구자가 해석하기 나름이라는 점을 유의해야합니다.</p>
</section>
<section id="id5">
<h4>비율 검증<a class="headerlink" href="#id5" title="이 표제에 대한 퍼머링크"></a></h4>
<p>battleground 에 구현된 빈도 통계 기반 비율 검증은 z 값을 통해 계산하며 추천 알고리즘 별 전환 유무(클릭/가입 등)를 검증하기 위한 목적으로 개발되었습니다. 비율 검증은 [6]를 참조하시면 자세한 내용을 보실 수 있습니다. H0는 두 집단간 비율에 차이가 없다이며 H1은 차이가 있다 입니다. 즉, 추천 알고리즘 별 전환 비율에 차이가 있는지를 검증하기 위한 목적으로 사용할 수 있으며 샘플 크기 추정을 통해 어느정도 수 이상의 샘플을 테스트 할 것이라고 가정하였기 때문에 분산 정규성 검증 등은 구현되어 있지 않습니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#z test 사용 예시</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_test</span> <span class="o">=</span> <span class="n">ConversionEstimater</span><span class="p">(</span><span class="n">control</span> <span class="o">=</span> <span class="n">bucket_a</span><span class="p">[[</span><span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="s1">&#39;prod_id&#39;</span><span class="p">,</span> <span class="s1">&#39;reward&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">random_bucket</span><span class="p">[[</span><span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="s1">&#39;prod_id&#39;</span><span class="p">,</span> <span class="s1">&#39;reward&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="p">,</span> <span class="n">control_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="p">,</span> <span class="n">target_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="p">,</span> <span class="n">control_reward_val</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="p">,</span> <span class="n">target_reward_val</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">control_prop</span><span class="p">,</span> <span class="n">treatment_prop</span><span class="p">,</span> <span class="n">z_stat</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">control_confidence_interval_control</span><span class="p">,</span> <span class="n">treatment_confidence_interval_control</span><span class="p">,</span> <span class="n">effect_size</span> <span class="o">=</span> <span class="n">z_test</span><span class="o">.</span><span class="n">prop_test</span><span class="p">()</span>            
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">p_val</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;추천 유무 별 전환 비율이 같다고 주장할 수 있다. 즉, 추천 유무가 전환에 영향을 준다고 주장할 수 있는 충분한 근거를 얻었다.&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;추천 유무 별 전환 비율이 같다고 주장할 수 없다. 즉, 추천 유무가 전환에 영향을 준다고 주장할 수 있는 충분한 근거를 얻지 못하였다.&quot;</span><span class="p">)</span>
<span class="go">추천 유무 별 전환 비율이 같다고 주장할 수 있다. 즉, 추천 유무가 전환에 영향을 준다고 주장할 수 있는 충분한 근거를 얻었다. #추천 알고리즘이 전환에 영향을 준다고 할 수 있다.</span>
</pre></div>
</div>
<p>반환되는 결과는 대조군 전환비율, 타겟군 전환비율, z 통계량과 p value, 대조군 신뢰구간, 타겟군 신뢰구간, 효과크기입니다. 반환된 결과를 기반으로 영향을 준다고 볼 수 있는지를 검증할 수 있으며 효과크기를 통해 얼만큼 영향을 준다고 볼 수 있는지를 검증할 수 있습니다. 카이제곱과 마찬가지로 이 크기가 절대적인 것은 아니며 상황과 데이터에 따라 p-value와 같이 연구자가 해석하기 나름이라는 점을 유의해야합니다.</p>
</section>
</section>
<section id="id6">
<h3>베이지안 기반<a class="headerlink" href="#id6" title="이 표제에 대한 퍼머링크"></a></h3>
<section id="a-b">
<h4>베이지안 A/B 테스트<a class="headerlink" href="#a-b" title="이 표제에 대한 퍼머링크"></a></h4>
<p>베이지안 검증은 A/B, A/B/C, A/B/C/D 테스트가 가능하도록 준비되어 있습니다. Battleground 에 구현되어있는 베이지안 검증은 보상이 Binary 인 경우에 한해 개발되었으니 사용에 유의를 해야합니다. 베이지안 A/B 계산은 아래의 수식을 따라 진행 됩니다. 아래의 수식은 유사한 결과를 산출하게 되며 자세한 증명은 [5]을 참조하시면 알 수 있습니다.</p>
<p><img alt="ab" src="../_images/ab.png" />
<img alt="ab2" src="../_images/ab2.png" /></p>
<ul class="simple">
<li><p>𝛼𝐴 : A 알고리즘의 전환(클릭 혹은 가입 등) 성공 수</p></li>
<li><p>𝛽𝐴 : A 알고리즘의 전환(클릭 혹은 가입 등) 실패 수</p></li>
<li><p>𝛼𝐵 : B 알고리즘의 전환(클릭 혹은 가입 등) 성공 수</p></li>
<li><p>𝛽𝐵 : B 알고리즘의 전환(클릭 혹은 가입 등) 실패 수</p></li>
<li><p>𝐵 : 베타 함수</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 베이지안 A/B 테스트 사용 예시</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">online_abtesting</span> <span class="o">=</span> <span class="n">ConversionEstimater</span><span class="p">(</span><span class="n">control</span> <span class="o">=</span> <span class="n">bucket_a</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">bucket_b_example</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">control_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">target_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">control_click_rate</span><span class="p">,</span> <span class="n">target_click_rate</span><span class="p">,</span> <span class="n">prob_b_a</span> <span class="o">=</span> <span class="n">online_abtesting</span><span class="o">.</span><span class="n">cal_bayes_prob</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Control Grp Click rate : &quot;</span><span class="p">,</span> <span class="n">control_click_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Target Grp Click rate : &quot;</span><span class="p">,</span> <span class="n">target_click_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;probability Pt &gt; Pc : &quot;</span><span class="p">,</span> <span class="n">prob_b_a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;지수형 -&gt; 숫자형 : &quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.8f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prob_b_a</span><span class="p">))</span>
<span class="go">Control Grp Click rate :  0.01483019427554501</span>
<span class="go">Target Grp Click rate :  0.0015598692680994354</span>
<span class="go">probability Pt &gt; Pc :  3.7421643192430597e-113</span>
<span class="go">지수형 -&gt; 숫자형 :  0.00000000</span>
</pre></div>
</div>
<p>반환되는 결과는 대조군 전환율, 타겟군 전환율, 타겟군이 대조군 대비 더 많이 전환될 확률입니다. 반환된 결과를 기반으로 영향을 준다고 볼 수 있는지를 검증할 수 있습니다. “집단 별 효과가 없다면 무작위 표본 추출 오류로 인해 연구의 n%에서 관찰된 수준 이상의 차이가 도출된다” 라고 해석해야하는 빈도 통계 기반 방법들과 다르게 베이지안 방법은 보다 직관적으로 “타겟군이 대조군 대비 더 많이 전환될 확률이 n이다”라고 해석할 수 있습니다. 빈도 통계 기반의 방법들은 모집단에 대해 귀무 가설이 참이며 표본의 차이가 오로지 무작위 확률에 의해 발생했다는 가정에 기반하여 계산되기 때문에 귀무 가설의 참, 거짓 확률을 나타낼 수 없는데 반해 베이지안 방법은 직관적으로 해석할 수 있습니다.</p>
</section>
<section id="a-b-c">
<h4>베이지안 A/B/C 테스트<a class="headerlink" href="#a-b-c" title="이 표제에 대한 퍼머링크"></a></h4>
<p>베이지안 A/B/C 검증은 아래의 수식을 따라 진행 됩니다. 자세한 증명은 [8]을 참조하시면 알 수 있습니다.</p>
<p><img alt="abc" src="../_images/abc.png" /></p>
<p>𝛼𝑋 : A, B, C 알고리즘 각각의 전환(클릭 혹은 가입 등) 성공 수, 𝑋∈{𝐴,𝐵,𝐶}.
𝛽𝑋 : A, B, C 알고리즘 각각의 전환(클릭 혹은 가입 등) 실패 수, 𝑋∈{𝐴,𝐵,𝐶}.
Pr(𝑝𝑋&gt;𝑝𝐶) : 베이지안 A/C, B/C 검증 결과, 𝑋∈{𝐴,𝐵,𝐶}.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 베이지안 A/B/C 테스트 사용 예시</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">online_abtesting</span> <span class="o">=</span> <span class="n">ConversionEstimater</span><span class="p">(</span><span class="n">control</span> <span class="o">=</span> <span class="n">bucket_a</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">bucket_b_example</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">control_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">target_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">control2</span> <span class="o">=</span> <span class="n">bucket_c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">control_click_rate</span><span class="p">,</span> <span class="n">control2_click_rate</span><span class="p">,</span> <span class="n">target_click_rate</span><span class="p">,</span> <span class="n">prob_b_a</span> <span class="o">=</span> <span class="n">online_abtesting</span><span class="o">.</span><span class="n">cal_multi_bayes_prob</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Control 1 Grp Click rate : &quot;</span><span class="p">,</span> <span class="n">control_click_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Control 2 Grp Click rate : &quot;</span><span class="p">,</span> <span class="n">control2_click_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Target Grp Click rate : &quot;</span><span class="p">,</span> <span class="n">target_click_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;probability Pt &gt; Pc : &quot;</span><span class="p">,</span> <span class="n">prob_t_c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;지수형 -&gt; 숫자형 : &quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.8f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prob_t_c</span><span class="p">))</span>
<span class="go">Control 1 Grp Click rate :  0.01483019427554501</span>
<span class="go">Control 2 Grp Click rate :  0.02323984298374124</span>
<span class="go">Target Grp Click rate :  0.0015598692680994354</span>
<span class="go">probability Pt &gt; Pc :  3.7421643192430597e-113</span>
<span class="go">지수형 -&gt; 숫자형 :  0.00000000</span>
</pre></div>
</div>
<p>반환되는 결과는 대조군 1 전환율, 대조군 2 전환율, 타겟군 전환율, 타겟군이 대조군 대비 더 많이 전환될 확률입니다. 베이지안 A/B 테스트와 동일하게 해석할 수 있습니다.</p>
</section>
<section id="a-b-c-d">
<h4>베이지안 A/B/C/D 테스트<a class="headerlink" href="#a-b-c-d" title="이 표제에 대한 퍼머링크"></a></h4>
<p>베이지안 A/B/C/D 검증은 아래의 수식을 따라 진행 됩니다. 자세한 증명은 [8]을 참조하시면 알 수 있습니다.</p>
<p><img alt="abcd" src="../_images/abcd.png" /></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 베이지안 A/B/C/D 테스트 사용 예시</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">online_abtesting</span> <span class="o">=</span> <span class="n">ConversionEstimater</span><span class="p">(</span><span class="n">control</span> <span class="o">=</span> <span class="n">bucket_a</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">bucket_b_example</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">control_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">target_reward_col</span> <span class="o">=</span> <span class="s1">&#39;reward&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">control2</span> <span class="o">=</span> <span class="n">bucket_c</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="p">,</span> <span class="n">control3</span> <span class="o">=</span> <span class="n">bucket_d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">control_click_rate</span><span class="p">,</span> <span class="n">control2_click_rate</span><span class="p">,</span> <span class="n">control3_click_rate</span><span class="p">,</span> <span class="n">target_click_rate</span><span class="p">,</span> <span class="n">prob_b_a</span> <span class="o">=</span> <span class="n">online_abtesting</span><span class="o">.</span><span class="n">cal_multi_bayes_prob</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Control 1 Grp Click rate : &quot;</span><span class="p">,</span> <span class="n">control_click_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Control 2 Grp Click rate : &quot;</span><span class="p">,</span> <span class="n">control2_click_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Control 3 Grp Click rate : &quot;</span><span class="p">,</span> <span class="n">control3_click_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Target Grp Click rate : &quot;</span><span class="p">,</span> <span class="n">target_click_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;probability Pt &gt; Pc : &quot;</span><span class="p">,</span> <span class="n">prob_t_c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;지수형 -&gt; 숫자형 : &quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.8f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prob_t_c</span><span class="p">))</span>
<span class="go">Control 1 Grp Click rate :  0.01483019427554501</span>
<span class="go">Control 2 Grp Click rate :  0.02323984298374124</span>
<span class="go">Control 3 Grp Click rate :  0.01231827391872837</span>
<span class="go">Target Grp Click rate :  0.0015598692680994354</span>
<span class="go">probability Pt &gt; Pc :  3.7421643192430597e-113</span>
<span class="go">지수형 -&gt; 숫자형 :  0.00000000</span>
</pre></div>
</div>
<p>반환되는 결과는 대조군 1 전환율, 대조군 2 전환율, 대조군 3 전환율, 타겟군 전환율, 타겟군이 대조군 대비 더 많이 전환될 확률입니다. 베이지안 A/B/C 테스트와 동일하게 해석할 수 있습니다.</p>
</section>
</section>
</section>
<section id="id7">
<h2>랭킹 기반 추천 성능<a class="headerlink" href="#id7" title="이 표제에 대한 퍼머링크"></a></h2>
<p>랭킹 기반 추천 성능은 MAP(Mean Average Precision), MAR(Mean Average Recall), nDCG(Normailzed Discounted Cumulative Gain)가 구현되어 있습니다. 사용에 유의할 점은 저희는 로그를 DB로부터 pandas 형태로 불러오는 것에 익숙하여 이를 그대로 넣을 수 있도록 개발이 되었는데 MAP나 MAR, nDCG 등을 계산할 때 추천의 순서 별로 정렬하여 넣어야 한다는 점입니다. 별도로 정렬 로직을 추가하려고 하다가 추천을 담당하는 담당자가 추천의 순서를 잘 알테니 과제마다 다른 경우를 고려하지 않고 정렬 로직을 심는 것 보다 추천의 내용과 데이터를 잘 아는 담당자가 정렬해서 데이터를 넣어 연산할 수 있도록 개발되었습니다. 유저 별로 가장 첫 번째로 추천되는 아이템을 처음으로 등장하도록 정렬한 뒤에 함수에 넣으면 그 순서를 기반으로 인덱싱을 수행하므로 정렬을 하지 않으면 제대로 된 결과를 출력하지 않을 수 있습니다.</p>
<section id="map">
<h3>MAP<a class="headerlink" href="#map" title="이 표제에 대한 퍼머링크"></a></h3>
<p>추천 시스템에서는 사용자가 관심을 더 많이 가질만한 아이템을 상위에 추천해주는 것이 매우 중요합니다. 이를 위해 성능 평가에 순서 개념을 도입한 것이 Mean Average Precision &#64; K 입니다. 계산은 아래의 그림을 보시면 이해하실 수 있습니다.</p>
<p><img alt="map" src="../_images/map.png" /></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># MAP(Mean Average Precision) 사용 예시</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">online_abtesting</span> <span class="o">=</span> <span class="n">RankingEstimater</span><span class="p">(</span><span class="n">rec</span> <span class="o">=</span> <span class="n">bucket_a</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">item_col</span> <span class="o">=</span> <span class="s1">&#39;prod_id&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">user_col</span> <span class="o">=</span> <span class="s1">&#39;ci&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">reward</span> <span class="o">=</span> <span class="s1">&#39;click_yn&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>        
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_cal</span> <span class="o">=</span> <span class="n">online_abtesting</span><span class="o">.</span><span class="n">mean_average_precision</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Average Precision : &quot;</span><span class="p">,</span> <span class="n">map_cal</span><span class="p">)</span>
<span class="go">Mean Average Precision : 0.5</span>
</pre></div>
</div>
</section>
<section id="mar">
<h3>MAR<a class="headerlink" href="#mar" title="이 표제에 대한 퍼머링크"></a></h3>
<p>MAP 가 Precision에 기반해 만들어졌다면 MAR은 Recall에 기반하여 만들어졌습니다. MAP계산에서 Precision 대신에 Recall을 대입하여 계산하게 됩니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># MAR(Mean Average Recall) 사용 예시</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">online_abtesting</span> <span class="o">=</span> <span class="n">RankingEstimater</span><span class="p">(</span><span class="n">rec</span> <span class="o">=</span> <span class="n">bucket_a</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">item_col</span> <span class="o">=</span> <span class="s1">&#39;prod_id&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">user_col</span> <span class="o">=</span> <span class="s1">&#39;ci&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">reward</span> <span class="o">=</span> <span class="s1">&#39;click_yn&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">reco_col</span> <span class="o">=</span> <span class="s1">&#39;impression_yn&#39;</span><span class="p">)</span>        
<span class="gp">&gt;&gt;&gt; </span><span class="n">mar_cal</span> <span class="o">=</span> <span class="n">online_abtesting</span><span class="o">.</span><span class="n">mean_average_recall</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Average Recall : &quot;</span><span class="p">,</span> <span class="n">mar_cal</span><span class="p">)</span>
<span class="go">Mean Average Recall : 0.5</span>
</pre></div>
</div>
</section>
<section id="ndcg">
<h3>nDCG<a class="headerlink" href="#ndcg" title="이 표제에 대한 퍼머링크"></a></h3>
<p>nDCG는 원래 검색 분야에서 등장한 지표이나 추천 시스템에도 많이 사용되고 있습니다. Top K개 아이템을 추천하는 경우, 추천 순서에 가중치를 두어 평가합니다. NDCG &#64; K값은 1에 가까울수록 좋은 성능을 보이는 것이며. 순서별로 가중치 값(관련도, relevance)을 다르게 적용하여 계산합니다. 계산은 아래의 그림을 보시면 이해하실 수 있습니다.</p>
<p><img alt="ndcg" src="../_images/ndcg.png" /></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># MAP(Mean Average Precision) 사용 예시</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">online_abtesting</span> <span class="o">=</span> <span class="n">RankingEstimater</span><span class="p">(</span><span class="n">rec</span> <span class="o">=</span> <span class="n">bucket_a</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">item_col</span> <span class="o">=</span> <span class="s1">&#39;prod_id&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">user_col</span> <span class="o">=</span> <span class="s1">&#39;ci&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">reward</span> <span class="o">=</span> <span class="s1">&#39;click_yn&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>        
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndcg</span> <span class="o">=</span> <span class="n">online_abtesting</span><span class="o">.</span><span class="n">ndcg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Normailzed Discounted Cumulative Gain : &quot;</span><span class="p">,</span> <span class="n">ndcg</span><span class="p">)</span>
<span class="go">Normailzed Discounted Cumulative Gain : 0.5</span>
</pre></div>
</div>
</section>
</section>
<section id="id8">
<h2>연속 값 차이 추정<a class="headerlink" href="#id8" title="이 표제에 대한 퍼머링크"></a></h2>
<p>battleground에는 Binary Conversion 성능 추정에 맞추어 개발이 되어 있습니다. 이유는 현재 T3K의 KPI는 비즈니스와 연관되어 CTR 향상을 해야하는 상황이고, CTR은 세부적으로 보면 클릭 한다/안한다의 action이 2개이기 때문에 Binary Conversion 성능 추정이 필요한 상황이고 현재 시점에서 아무런 것도 개발이 안되어있기 때문에 우선순위를 맞추어 Binary Conversion 성능 추정에 초점을 맞추어 개발하였습니다.</p>
<p>그러나 A/B 테스트는 Binary Conversion 외에도 다양한 방법으로 진행이 될 수 있습니다. 예를 들어, 페이지에 머문 시간, 페이지에 어느 위치까지 보았는지, 총 매출 등 다양한 환경에서 진행할 수 있기 때문에 연속적인 값(Continuous)도 성능을 추정할 수 있도록 하기 위하여 개발되었습니다.</p>
<section id="t">
<h3>독립 표본 T 검증<a class="headerlink" href="#t" title="이 표제에 대한 퍼머링크"></a></h3>
<p>A/B 테스트를 위해 독립적인 두 모집단에서 추출된 샘플 간 비교를 위해 독립 표본 T검증을 준비해두었습니다. 자세한 내용은 [7]을 참조하시면 보실 수 있습니다. 사용 예시는 아래와 같습니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">control</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ttest</span> <span class="o">=</span> <span class="n">ContinuousCompare</span><span class="p">(</span><span class="n">control</span> <span class="o">=</span> <span class="n">control</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="p">)</span>        
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_stat</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">effect_size</span> <span class="o">=</span> <span class="n">ttest</span><span class="o">.</span><span class="n">ttest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">p_val</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;집단 별 평균이 같지 않다고 주장할 충분한 근거를 얻지 못하였다.&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;집단 별 평균이 같지 않다고 주장할 충분한 근거를 얻었다.&quot;</span><span class="p">)</span>
<span class="go">집단 별 평균이 같지 않다고 주장할 충분한 근거를 얻었다.</span>
</pre></div>
</div>
<p>반환되는 결과는 크게 세가지로 t통계량, p value, 효과크기를 반환합니다. 이를 통해 두 집단 간 표본 평균으로 추정한 모집단의 평균이 차이가 있는지, 있다면 어느정도 차이로 차이가 있는지를 볼 수 있습니다.</p>
</section>
<section id="id9">
<h3>베이지안 T 검증<a class="headerlink" href="#id9" title="이 표제에 대한 퍼머링크"></a></h3>
<p>베이지안 T 검증은 [8]에 기반하여 개발되었습니다. 자세한 내용은 [8]을 참조하시면 보실 수 있습니다. 아래는 사용 예시입니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">control</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_val</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ttest</span> <span class="o">=</span> <span class="n">ContinuousCompare</span><span class="p">(</span><span class="n">control</span> <span class="o">=</span> <span class="n">control</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">target</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">diff_val</span><span class="p">)</span>        
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">ttest</span><span class="o">.</span><span class="n">bayes_ttest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;target 그룹의 평균이 control 그룹의 평균보다 </span><span class="si">{</span><span class="n">diff_val</span><span class="si">}</span><span class="s2"> 만큼 클 확률 : &quot;</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>
<span class="go">target 그룹의 평균이 control 그룹의 평균보다 0.01 만큼 클 확률 : 0.6</span>
</pre></div>
</div>
<hr class="docutils" />
<p>[1] https://statistics.stanford.edu/technical-reports/determining-appropriate-sample-size-confidence-limits-proportion</p>
<p>[2] https://www.evanmiller.org/ab-testing/sample-size-fixed.js</p>
<p>[3] https://www.evanmiller.org/ab-testing/sample-size.html</p>
<p>[4] https://en.wikipedia.org/wiki/Chi-squared_test</p>
<p>[5] https://www.evanmiller.org/bayesian-ab-testing.html#count_ab</p>
<p>[6] https://vitalflux.com/two-sample-z-test-for-proportions-formula-examples/</p>
<p>[7] https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html</p>
<p>[8] https://best.readthedocs.io/en/latest/index.html</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="offline_ab_test.html" class="btn btn-neutral float-left" title="Offline A/B 테스트" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../modules.html" class="btn btn-neutral float-right" title="battleground" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 저작권 2022, Customer Analytics, SKT.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>